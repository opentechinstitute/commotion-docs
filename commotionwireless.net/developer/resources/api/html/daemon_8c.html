<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Commotion Wireless: src/daemon.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Commotion Wireless
   </div>
   <div id="projectbrief">Commotion is a wireless mesh networking toolkit.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">daemon.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>commotiond - an embedded C daemon for managing mesh networks.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;getopt.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;limits.h&gt;</code><br/>
<code>#include &quot;config.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cmd_8h_source.html">cmd.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util_8h_source.html">util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="loop_8h_source.html">loop.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="plugin_8h_source.html">plugin.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="process_8h_source.html">process.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="profile_8h_source.html">profile.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="socket_8h_source.html">socket.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="msg_8h_source.html">msg.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iface_8h_source.html">iface.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="id_8h_source.html">id.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="obj_8h_source.html">obj.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="list_8h_source.html">list.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tree_8h_source.html">tree.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aed167a6fd20a96a7d72a87558e1798f2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aed167a6fd20a96a7d72a87558e1798f2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>REQUEST_MAX</b>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:aed167a6fd20a96a7d72a87558e1798f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14c6b4a2d0888268744a6496ee33183"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac14c6b4a2d0888268744a6496ee33183"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RESPONSE_MAX</b>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:ac14c6b4a2d0888268744a6496ee33183"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a940b48b3bfcda0769ea52c6c1e797e4b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a940b48b3bfcda0769ea52c6c1e797e4b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SCHEMA</b> (default)</td></tr>
<tr class="separator:a940b48b3bfcda0769ea52c6c1e797e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf1b7f8fddaa1bc3e9a88eec93a7649"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cf1b7f8fddaa1bc3e9a88eec93a7649"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SCHEMA</b> (global)</td></tr>
<tr class="separator:a5cf1b7f8fddaa1bc3e9a88eec93a7649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96a24001c137324549512cf28d8f4084"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a96a24001c137324549512cf28d8f4084"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (help)</td></tr>
<tr class="separator:a96a24001c137324549512cf28d8f4084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abccaf4abcdcdb5b2fb84969205c50618"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abccaf4abcdcdb5b2fb84969205c50618"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (profiles)</td></tr>
<tr class="separator:abccaf4abcdcdb5b2fb84969205c50618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc27086e79e6b66573bdfb678d3992c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afbc27086e79e6b66573bdfb678d3992c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (up)</td></tr>
<tr class="separator:afbc27086e79e6b66573bdfb678d3992c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a917c82ba53e7543b36ef0d2a21b369ca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a917c82ba53e7543b36ef0d2a21b369ca"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (down)</td></tr>
<tr class="separator:a917c82ba53e7543b36ef0d2a21b369ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8157d50ea6c088206d0d9c729891de70"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8157d50ea6c088206d0d9c729891de70"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (status)</td></tr>
<tr class="separator:a8157d50ea6c088206d0d9c729891de70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a58c28fd804f8beb8b6ff2fd85e2a4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a43a58c28fd804f8beb8b6ff2fd85e2a4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (state)</td></tr>
<tr class="separator:a43a58c28fd804f8beb8b6ff2fd85e2a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03b020e3e677f7b2e1ef15d3eb38bb5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af03b020e3e677f7b2e1ef15d3eb38bb5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (nodeid)</td></tr>
<tr class="separator:af03b020e3e677f7b2e1ef15d3eb38bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07f8f805ac4fdfbb9d3c21832da28cde"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a07f8f805ac4fdfbb9d3c21832da28cde"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (genip)</td></tr>
<tr class="separator:a07f8f805ac4fdfbb9d3c21832da28cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae240b8e752c1d73259a3bec7f7f5ac98"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae240b8e752c1d73259a3bec7f7f5ac98"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (genbssid)</td></tr>
<tr class="separator:ae240b8e752c1d73259a3bec7f7f5ac98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9318c76808478b3acd98eee8e986b55"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab9318c76808478b3acd98eee8e986b55"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (set)</td></tr>
<tr class="separator:ab9318c76808478b3acd98eee8e986b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed19a0e2fba907b0ec248713840e196"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afed19a0e2fba907b0ec248713840e196"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (get)</td></tr>
<tr class="separator:afed19a0e2fba907b0ec248713840e196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e5d414e43a00f66cc96d71544ecc45"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa4e5d414e43a00f66cc96d71544ecc45"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (save)</td></tr>
<tr class="separator:aa4e5d414e43a00f66cc96d71544ecc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0418f34318e13b2e7df46db6716eb117"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0418f34318e13b2e7df46db6716eb117"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (new)</td></tr>
<tr class="separator:a0418f34318e13b2e7df46db6716eb117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd760510e5542d470830dded0f65c1d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1dd760510e5542d470830dded0f65c1d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CMD</b> (delete)</td></tr>
<tr class="separator:a1dd760510e5542d470830dded0f65c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af68a09cb7d1ba46ac46187c590dc6468"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#af68a09cb7d1ba46ac46187c590dc6468">dispatcher_cb</a> (<a class="el" href="structco__obj__t.html">co_obj_t</a> *self, <a class="el" href="structco__obj__t.html">co_obj_t</a> *fd)</td></tr>
<tr class="memdesc:af68a09cb7d1ba46ac46187c590dc6468"><td class="mdescLeft">&#160;</td><td class="mdescRight">sends/receives socket messages  <a href="#af68a09cb7d1ba46ac46187c590dc6468">More...</a><br/></td></tr>
<tr class="separator:af68a09cb7d1ba46ac46187c590dc6468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates sockets for event loop, daemon and dispatcher. Starts/stops event loop. <br/></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa65a52def72a691a94bbe3b7e993c1b8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa65a52def72a691a94bbe3b7e993c1b8"></a>
<a class="el" href="structco__socket__t.html">co_socket_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>unix_socket_proto</b></td></tr>
<tr class="separator:aa65a52def72a691a94bbe3b7e993c1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>commotiond - an embedded C daemon for managing mesh networks. </p>
<dl class="section author"><dt>Author</dt><dd>Josh King (jheretic), <a href="#" onclick="location.href='mai'+'lto:'+'jki'+'ng'+'@ch'+'am'+'ban'+'a.'+'net'; return false;">jking<span style="display: none;">.nosp@m.</span>@cha<span style="display: none;">.nosp@m.</span>mbana<span style="display: none;">.nosp@m.</span>.net</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af68a09cb7d1ba46ac46187c590dc6468"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dispatcher_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structco__obj__t.html">co_obj_t</a> *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structco__obj__t.html">co_obj_t</a> *&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sends/receives socket messages </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>pointer to dispatcher socket struct </td></tr>
    <tr><td class="paramname">fd</td><td>file descriptor object of connected socket </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="cmd_8h.html#a3e3db670f8a4187b7e198804c2e8dd6a">co_cmd_exec()</a>, <a class="el" href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element()</a>, <a class="el" href="list_8c.html#a07c935572c069373bddadf2907a09b2b">co_list_import()</a>, <a class="el" href="msg_8c.html#aee952060c704142198bfa0de4c5d8c93">co_response_alloc()</a>, and <a class="el" href="tree_8c.html#a1693a84a751373827f76a7383322e105">co_tree_insert()</a>.</p>

<p>Referenced by <a class="el" href="daemon_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                                {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  CHECK(IS_SOCK(<span class="keyword">self</span>),<span class="stringliteral">&quot;Not a socket.&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <a class="code" href="structco__socket__t.html">co_socket_t</a> *sock = (<a class="code" href="structco__socket__t.html">co_socket_t</a>*)<span class="keyword">self</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordtype">char</span> reqbuf[REQUEST_MAX];</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  memset(reqbuf, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(reqbuf));</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  ssize_t reqlen = 0;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">char</span> respbuf[RESPONSE_MAX];</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  memset(respbuf, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(respbuf));</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">size_t</span> resplen = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <a class="code" href="structco__obj__t.html">co_obj_t</a> *request = NULL;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  uint8_t *type = NULL;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  uint32_t *<span class="keywordtype">id</span> = NULL;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <a class="code" href="structco__obj__t.html">co_obj_t</a> *nil = co_nil_create(0);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="comment">/* Incoming message on socket */</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  reqlen = sock-&gt;receive((<a class="code" href="structco__obj__t.html">co_obj_t</a>*)sock, fd, reqbuf, <span class="keyword">sizeof</span>(reqbuf));</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  DEBUG(<span class="stringliteral">&quot;Received %d bytes.&quot;</span>, (<span class="keywordtype">int</span>)reqlen);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">if</span>(reqlen == 0) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    INFO(<span class="stringliteral">&quot;Received connection.&quot;</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span> (reqlen &lt; 0) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    INFO(<span class="stringliteral">&quot;Connection recvd() -1&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    sock-&gt;hangup((<a class="code" href="structco__obj__t.html">co_obj_t</a>*)sock, fd);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="comment">/* If it&#39;s a commotion message type, parse the header, target and payload */</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  CHECK(<a class="code" href="list_8c.html#a07c935572c069373bddadf2907a09b2b">co_list_import</a>(&amp;request, reqbuf, reqlen) &gt; 0, <span class="stringliteral">&quot;Failed to import request.&quot;</span>);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  co_obj_data((<span class="keywordtype">char</span> **)&amp;type, <a class="code" href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element</a>(request, 0)); </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  CHECK(*type == 0, <span class="stringliteral">&quot;Not a valid request.&quot;</span>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  CHECK(co_obj_data((<span class="keywordtype">char</span> **)&amp;<span class="keywordtype">id</span>, <a class="code" href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element</a>(request, 1)) == <span class="keyword">sizeof</span>(uint32_t), <span class="stringliteral">&quot;Not a valid request ID.&quot;</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="structco__obj__t.html">co_obj_t</a> *ret = NULL;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="cmd_8h.html#a3e3db670f8a4187b7e198804c2e8dd6a">co_cmd_exec</a>(<a class="code" href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element</a>(request, 2), &amp;ret, <a class="code" href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element</a>(request, 3)))</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    resplen = <a class="code" href="msg_8c.html#aee952060c704142198bfa0de4c5d8c93">co_response_alloc</a>(respbuf, <span class="keyword">sizeof</span>(respbuf), *<span class="keywordtype">id</span>, nil, ret);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    sock-&gt;send(fd, respbuf, resplen);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span>(ret == NULL)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      ret = co_tree16_create();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="tree_8c.html#a1693a84a751373827f76a7383322e105">co_tree_insert</a>(ret, <span class="stringliteral">&quot;error&quot;</span>, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;error&quot;</span>), co_str8_create(<span class="stringliteral">&quot;Incorrect command.&quot;</span>, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;Incorrect command.&quot;</span>), 0));</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    resplen = <a class="code" href="msg_8c.html#aee952060c704142198bfa0de4c5d8c93">co_response_alloc</a>(respbuf, <span class="keyword">sizeof</span>(respbuf), *<span class="keywordtype">id</span>, ret, nil);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    sock-&gt;send(fd, respbuf, resplen);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  co_obj_free(nil);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  co_obj_free(request);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  co_obj_free(ret);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;error:</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  co_obj_free(nil);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  co_obj_free(request);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  co_obj_free(ret);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="ttc" id="cmd_8h_html_a3e3db670f8a4187b7e198804c2e8dd6a"><div class="ttname"><a href="cmd_8h.html#a3e3db670f8a4187b7e198804c2e8dd6a">co_cmd_exec</a></div><div class="ttdeci">int co_cmd_exec(co_obj_t *key, co_obj_t **output, co_obj_t *param)</div><div class="ttdoc">executes a command by running the function linked to in the command struct </div><div class="ttdef"><b>Definition:</b> cmd.c:109</div></div>
<div class="ttc" id="structco__obj__t_html"><div class="ttname"><a href="structco__obj__t.html">co_obj_t</a></div><div class="ttdef"><b>Definition:</b> obj.h:131</div></div>
<div class="ttc" id="structco__socket__t_html"><div class="ttname"><a href="structco__socket__t.html">co_socket_t</a></div><div class="ttdef"><b>Definition:</b> socket.h:65</div></div>
<div class="ttc" id="msg_8c_html_aee952060c704142198bfa0de4c5d8c93"><div class="ttname"><a href="msg_8c.html#aee952060c704142198bfa0de4c5d8c93">co_response_alloc</a></div><div class="ttdeci">size_t co_response_alloc(char *output, const size_t olen, const uint32_t id, const co_obj_t *error, co_obj_t *result)</div><div class="ttdoc">allocate response </div><div class="ttdef"><b>Definition:</b> msg.c:141</div></div>
<div class="ttc" id="list_8c_html_a07c935572c069373bddadf2907a09b2b"><div class="ttname"><a href="list_8c.html#a07c935572c069373bddadf2907a09b2b">co_list_import</a></div><div class="ttdeci">size_t co_list_import(co_obj_t **list, const char *input, const size_t ilen)</div><div class="ttdoc">import list from raw representation </div><div class="ttdef"><b>Definition:</b> list.c:562</div></div>
<div class="ttc" id="tree_8c_html_a1693a84a751373827f76a7383322e105"><div class="ttname"><a href="tree_8c.html#a1693a84a751373827f76a7383322e105">co_tree_insert</a></div><div class="ttdeci">int co_tree_insert(co_obj_t *root, const char *key, const size_t klen, co_obj_t *value)</div><div class="ttdoc">insert object into given tree and associate with key </div><div class="ttdef"><b>Definition:</b> tree.c:332</div></div>
<div class="ttc" id="list_8c_html_a647ff4c713547b65d3fa7a1a7cc7dff7"><div class="ttname"><a href="list_8c.html#a647ff4c713547b65d3fa7a1a7cc7dff7">co_list_element</a></div><div class="ttdeci">co_obj_t * co_list_element(co_obj_t *list, const unsigned int index)</div><div class="ttdoc">return item at specified position in list </div><div class="ttdef"><b>Definition:</b> list.c:483</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 6 2014 10:55:26 for Commotion Wireless by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
